. qui binsregselect y x w, simsgrid(30) savegrid(output/parfitval) replace

. qui reg y x w

. use output/parfitval, clear

. predict binsreg_fit_lm
(option xb assumed; fitted values)

. save output/parfitval, replace
file output/parfitval.dta saved

. use binsreg_simdata, clear

. binstest y x w, testmodelparfit(output/parfitval) lp(2)

Hypothesis tests based on binscatter estimates
Estimation method: reg
Bin selection method: IMSE-optimal plug-in choice
Placement: Quantile-spaced
Derivative: 0

----------------------------------------------
# of observations             |    1000
# of distinct values          |    1000
# of clusters                 |       .
------------------------------+---------------
Bin selection:                | 
         Degree of polynomial |       2
  # of smoothness constraints |       2
                    # of bins |       4
----------------------------------------------

Model specification Tests:
Degree: 3     # of smoothness constraints: 3

Input file: output/parfitval.dta
--------------------------------------------------
H0: mu =           | L2 of T           p value
-------------------+------------------------------
   binsreg_fit_lm  |   2.337             0.000
--------------------------------------------------
